/*!
 * eventful v0.2
 * https://github.com/AlphaHydrae/eventful
 *
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 * Alpha Hydrae (hydrae.alpha@gmail.com)
 */
(function(e){function j(){this._callbacks={}}j.prototype.on=function(k,n,l){d(k);if(typeof(n)==="undefined"&&typeof(l)==="undefined"){var m=[];this._eachCallback(k,function(o){m.push(o.callback)});return m}if(!this._callbacks[k]){this._callbacks[k]=[]}this._callbacks[k].push(this._wrapCallback(n,k,l));return this};j.prototype.off=function(k,m){if(typeof(k)==="undefined"){for(var l in this._callbacks){if(this._callbacks.hasOwnProperty(l)){this._removeAllCallbacks(l)}}return this}if(!this._callbacks[k]){return this}if(typeof(m)==="undefined"){this._removeAllCallbacks(k);return this}this._eachCallback(k,function(o,n){if(o.callback===m){this._callbacks[k].splice(n,1);return -1}});if(this._callbacks[k].length<=0){this._removeAllCallbacks(k)}return this};j.prototype.emit=function(k){var l=Array.prototype.slice.call(arguments,1);this._fireCallbacks(this._wrapEvent(k),l);return this};j.prototype.withNamespace=function(k){return new g(this,k)};j.prototype.withoutNamespace=function(){return this};j.prototype._fireCallbacks=function(k,l){this._eachCallback(k.eventName,function(n,m){if(k.shouldFire(n)&&n.shouldBeFired(k)){n.callIt.apply(n,l)}})};j.prototype._eachCallback=function(l,p){if(!this._callbacks[l]){return this}var k=null;var o=this._callbacks[l].length;for(var m=0;m<o;m++){k=p.call(this,this._callbacks[l][m],m);if(typeof(k)==="number"){m+=k;o+=k}else{if(k===false){break}}}return this};j.prototype._removeAllCallbacks=function(k){delete this._callbacks[k]};j.prototype._removeCallback=function(k,l){this._eachCallback(k,function(n,m){if(n===l){this._callbacks[k].splice(m,1);return false}})};j.prototype._wrapCallback=function(m,k,l){return new i(this,m,k,l)};j.prototype._wrapEvent=function(k){return new c(this,k)};function i(m,n,k,l){f(n);this.emitter=m;this.callback=n;this.eventName=k;this.scope=l&&l.scope?l.scope:undefined;this.once=l?!!l.once:undefined;this.klass=l?!!l.klass:undefined}i.prototype.callIt=function(){var k=Array.prototype.slice.call(arguments);if(this.klass){this.callAsClass(k)}else{this.callAsFunction(k)}if(this.once){this.emitter._removeCallback(this.eventName,this)}};i.prototype.callAsFunction=function(k){this.callback.apply(this.scope,k)};i.prototype.callAsClass=function(m){var l=function(){};l.prototype=this.callback.prototype;var k=new l();this.callback.apply(k,m)};i.prototype.shouldBeFired=function(k){return true};function c(l,k){this.emitter=l;this.eventName=k}c.prototype.shouldFire=function(k){return true};function d(k){if(typeof(k)!=="string"||!k.match(/^\w+$/i)){throw new Error("Event names must be non-empty word strings.")}}function f(k){if(typeof(k)!=="function"){throw new Error("Event callbacks must be functions.")}}function b(l,k){for(var m in l.prototype){if(m.match(/^_?[a-z]/)){k.prototype[m]=l.prototype[m]}}}function g(l,k){this._emitter=l;this._namespace=k;this._callbacks=this._emitter._callbacks}b(j,g);g.prototype.withNamespace=function(k){return new g(this._emitter,k)};g.prototype.withoutNamespace=function(){return this._emitter};g.prototype._wrapCallback=function(m,k,l){return new a(this._namespace,this,m,k,l)};g.prototype._wrapEvent=function(k){return new h(this._namespace,this,k)};function a(m,n,o,k,l){i.call(this,n,o,k,l);this.namespace=m}b(i,a);a.prototype.shouldBeFired=function(k){return this.namespace===k.namespace};function h(l,m,k){c.call(this,m,k);this.namespace=l}b(c,h);if(typeof(module)==="object"){module.exports=j}else{e.EventEmitter=j}})(this);